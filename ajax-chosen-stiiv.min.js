!function(a){return a.fn.ajaxChosenStiiv=function(b,c,d){var e,f,g,h;return null==b&&(b={}),null==d&&(d={}),f={minTermLength:3,afterTypeDelay:500,jsonTermKey:"term",keepTypingMsg:"Keep typing...",lookingForMsg:"Looking for"},h=this,e=null,g=a.extend({},f,a(h).data(),b),this.chosen(d?d:{}),this.each(function(){return a(this).next(".chosen-container").find(".search-field > input, .chosen-search > input").bind("keyup",function(){var d,f,i,j,k;return j=a(this).val(),k=a.trim(a(this).val()),f=k.length<g.minTermLength?g.keepTypingMsg:g.lookingForMsg+(" '"+k+"'"),h.next(".chosen-container").find(".no-results").text(f),k!==a(this).data("prevVal")&&(a(this).data("prevVal",k),this.timer&&clearTimeout(this.timer),!(k.length<g.minTermLength)&&(d=a(this),null==g.data&&(g.data={}),g.data[g.jsonTermKey]=k,null!=g.dataCallback&&(g.data=g.dataCallback(g.data)),i=g.success,g.success=function(e){var f,g,i;if(null!=e)return i=[],h.find("option").each(function(){return a(this).is(":selected")?i.push(a(this).val()+"-"+a(this).text()):a(this).remove()}),h.find("optgroup:empty").each(function(){return a(this).remove()}),f=null!=c?c(e,d):e,g=0,a.each(f,function(b,c){var d,e,f;return g++,c.group?(d=h.find("optgroup[label='"+c.text+"']"),d.size()||(d=a("<optgroup />")),d.attr("label",c.text).appendTo(h),a.each(c.items,function(b,c){var e,f;if("string"==typeof c?(f=b,e=c):(f=c.value,e=c.text),a.inArray(f+"-"+e,i)===-1)return a("<option />").attr("value",f).html(e).appendTo(d)})):("string"==typeof c?(f=b,e=c):(f=c.value,e=c.text),a.inArray(f+"-"+e,i)===-1?a("<option />").attr("value",f).html(e).appendTo(h):void 0)}),g?h.trigger("chosen:updated"):(h.data().chosen.no_results_clear(),h.data().chosen.no_results(d.val())),null!=b.success&&b.success(e),d.val(j)},this.timer=setTimeout(function(){return e&&e.abort(),e=a.ajax(g)},g.afterTypeDelay)))})})}}(jQuery);
